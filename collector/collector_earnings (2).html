<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Earnings - EcoWaste Collector</title>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    background: #f8fafb;
    color: #2c3e50;
    overflow-x: hidden;
}

.dashboard-container {
    display: flex;
    min-height: 100vh;
}

/* Sidebar Styles */
.sidebar {
    width: 280px;
    background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
    color: white;
    position: fixed;
    height: 100vh;
    transition: all 0.3s ease;
    z-index: 1000;
    box-shadow: 2px 0 15px rgba(0,0,0,0.1);
}

.sidebar.collapsed {
    width: 70px;
}

.sidebar-header {
    padding: 25px 20px;
    border-bottom: 1px solid rgba(255,255,255,0.1);
    display: flex;
    align-items: center;
    gap: 15px;
}

.logo {
    font-size: 24px;
    font-weight: 800;
    display: flex;
    align-items: center;
    gap: 10px;
}

.logo i {
    font-size: 28px;
}

.collapse-btn {
    background: none;
    border: none;
    color: white;
    font-size: 18px;
    cursor: pointer;
    padding: 5px;
    border-radius: 5px;
    transition: background 0.3s ease;
    margin-left: auto;
}

.collapse-btn:hover {
    background: rgba(255,255,255,0.1);
}

.sidebar-menu {
    padding: 20px 0;
}

.menu-item {
    display: flex;
    align-items: center;
    padding: 15px 20px;
    color: rgba(255,255,255,0.8);
    text-decoration: none;
    transition: all 0.3s ease;
    position: relative;
    gap: 15px;
    font-weight: 500;
    cursor: pointer;
}

.menu-item:hover {
    background: rgba(255,255,255,0.1);
    color: white;
    transform: translateX(5px);
}

.menu-item.active {
    background: rgba(255,255,255,0.15);
    color: white;
    border-right: 4px solid #fff;
}

.menu-item i {
    font-size: 18px;
    width: 20px;
    text-align: center;
}

.sidebar.collapsed .menu-item span {
    display: none;
}

.sidebar.collapsed .logo span {
    display: none;
}

/* Main Content */
.main-content {
    flex: 1;
    margin-left: 280px;
    transition: margin-left 0.3s ease;
}

.main-content.expanded {
    margin-left: 70px;
}

/* Top Navigation */
.top-nav {
    background: white;
    padding: 15px 30px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    display: flex;
    justify-content: space-between;
    align-items: center;
    position: sticky;
    top: 0;
    z-index: 100;
}

.nav-title {
    font-size: 28px;
    font-weight: 700;
    color: #2c3e50;
}

.user-profile {
    display: flex;
    align-items: center;
    gap: 15px;
    cursor: pointer;
    padding: 8px 15px;
    border-radius: 25px;
    transition: background 0.3s ease;
}

.user-profile:hover {
    background: #f8f9fa;
}

.user-avatar {
    width: 45px;
    height: 45px;
    border-radius: 50%;
    background: linear-gradient(135deg, #3498db, #2980b9);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: 600;
    font-size: 16px;
}

.user-info h4 {
    font-size: 14px;
    color: #2c3e50;
}

.user-info p {
    font-size: 12px;
    color: #7f8c8d;
}

/* Dashboard Content */
.dashboard-content {
    padding: 30px;
}

/* Page Header */
.page-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 30px;
    flex-wrap: wrap;
    gap: 20px;
}

.breadcrumbs {
    display: flex;
    align-items: center;
    gap: 10px;
    color: #7f8c8d;
    font-size: 14px;
}

.breadcrumb-item {
    color: #7f8c8d;
}

.breadcrumb-item.active {
    color: #2c3e50;
    font-weight: 600;
}

.quick-actions {
    display: flex;
    gap: 15px;
}

.action-btn-header {
    background: linear-gradient(135deg, #3498db, #2980b9);
    color: white;
    border: none;
    padding: 12px 20px;
    border-radius: 25px;
    font-weight: 600;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: all 0.3s ease;
    white-space: nowrap;
}

.action-btn-header:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 25px rgba(52, 152, 219, 0.3);
}

.withdraw-btn {
    background: linear-gradient(135deg, #2ecc71, #27ae60);
}

.withdraw-btn:hover {
    box-shadow: 0 10px 25px rgba(46, 204, 113, 0.3);
}

/* Earnings Overview */
.earnings-overview {
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    color: white;
    padding: 30px;
    border-radius: 15px;
    margin-bottom: 30px;
    position: relative;
    overflow: hidden;
}

.earnings-overview::before {
    content: 'ðŸ’°';
    position: absolute;
    top: -20px;
    right: -20px;
    font-size: 120px;
    opacity: 0.1;
}

.earnings-content {
    position: relative;
    z-index: 2;
}

.earnings-title {
    font-size: 24px;
    margin-bottom: 10px;
}

.earnings-subtitle {
    opacity: 0.9;
    margin-bottom: 25px;
}

.earnings-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 30px;
}

.earnings-stat {
    text-align: center;
}

.earnings-stat-value {
    font-size: 32px;
    font-weight: 700;
    margin-bottom: 5px;
}

.earnings-stat-label {
    font-size: 14px;
    opacity: 0.8;
}

/* Period Selector */
.period-selector {
    background: white;
    padding: 20px;
    border-radius: 15px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.08);
    margin-bottom: 30px;
}

.period-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
}

.period-title {
    font-size: 18px;
    font-weight: 700;
    color: #2c3e50;
}

.period-buttons {
    display: flex;
    gap: 5px;
    background: #f8f9fa;
    padding: 3px;
    border-radius: 8px;
}

.period-btn {
    background: none;
    border: none;
    padding: 8px 16px;
    border-radius: 6px;
    cursor: pointer;
    color: #7f8c8d;
    font-weight: 500;
    transition: all 0.3s ease;
}

.period-btn.active {
    background: white;
    color: #2c3e50;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.custom-period {
    display: flex;
    gap: 15px;
    align-items: center;
}

.date-input {
    padding: 8px 12px;
    border: 1px solid #e0e6ed;
    border-radius: 6px;
    font-size: 14px;
    color: #2c3e50;
}

.date-input:focus {
    outline: none;
    border-color: #3498db;
    box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
}

/* Main Grid */
.earnings-grid {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: 30px;
    margin-bottom: 30px;
}

/* Charts */
.chart-container {
    background: white;
    border-radius: 15px;
    padding: 25px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.08);
}

.chart-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 1px solid #f1f3f4;
}

.chart-title {
    font-size: 18px;
    font-weight: 700;
    color: #2c3e50;
}

.chart-subtitle {
    color: #7f8c8d;
    font-size: 14px;
}

.chart-canvas {
    width: 100% !important;
    height: 300px !important;
}

/* Earnings Breakdown */
.earnings-breakdown {
    background: white;
    border-radius: 15px;
    padding: 25px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.08);
}

.breakdown-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px 0;
    border-bottom: 1px solid #f8f9fa;
}

.breakdown-item:last-child {
    border-bottom: none;
}

.breakdown-label {
    display: flex;
    align-items: center;
    gap: 10px;
    color: #2c3e50;
    font-weight: 500;
}

.breakdown-icon {
    width: 35px;
    height: 35px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 14px;
}

.icon-plastic { background: linear-gradient(135deg, #e74c3c, #c0392b); }
.icon-paper { background: linear-gradient(135deg, #9b59b6, #8e44ad); }
.icon-ewaste { background: linear-gradient(135deg, #2ecc71, #27ae60); }
.icon-metal { background: linear-gradient(135deg, #f39c12, #e67e22); }
.icon-glass { background: linear-gradient(135deg, #3498db, #2980b9); }
.icon-organic { background: linear-gradient(135deg, #1abc9c, #16a085); }

.breakdown-value {
    font-weight: 700;
    color: #27ae60;
    font-size: 16px;
}

.breakdown-percentage {
    font-size: 12px;
    color: #7f8c8d;
    margin-left: 5px;
}

/* Payment History */
.payment-history {
    background: white;
    border-radius: 15px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.08);
    overflow: hidden;
}

.payment-header {
    background: #fafbfc;
    padding: 20px 25px;
    border-bottom: 1px solid #f1f3f4;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.section-title {
    font-size: 20px;
    font-weight: 700;
    color: #2c3e50;
    display: flex;
    align-items: center;
    gap: 10px;
}

.payment-filters {
    display: flex;
    gap: 10px;
}

.filter-btn {
    background: white;
    border: 1px solid #e0e6ed;
    padding: 6px 12px;
    border-radius: 6px;
    cursor: pointer;
    color: #7f8c8d;
    font-size: 12px;
    transition: all 0.3s ease;
}

.filter-btn.active {
    background: #3498db;
    border-color: #3498db;
    color: white;
}

.payment-table {
    width: 100%;
    border-collapse: collapse;
}

.payment-table th {
    text-align: left;
    padding: 15px 20px;
    background: #fafbfc;
    border-bottom: 1px solid #f1f3f4;
    font-weight: 600;
    color: #555;
    font-size: 13px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.payment-table td {
    padding: 15px 20px;
    border-bottom: 1px solid #f8f9fa;
    color: #555;
    vertical-align: middle;
}

.payment-table tr:hover {
    background: #f8f9fa;
}

.payment-amount {
    font-weight: 700;
    color: #27ae60;
}

.payment-status {
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 11px;
    font-weight: 600;
    text-transform: uppercase;
}

.status-paid { background: #d4edda; color: #155724; }
.status-pending { background: #fff3cd; color: #856404; }
.status-processing { background: #d1ecf1; color: #0c5460; }

/* Goals Section */
.goals-section {
    background: white;
    border-radius: 15px;
    padding: 25px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.08);
    margin-bottom: 30px;
}

.goal-item {
    margin-bottom: 25px;
    padding-bottom: 20px;
    border-bottom: 1px solid #f8f9fa;
}

.goal-item:last-child {
    margin-bottom: 0;
    padding-bottom: 0;
    border-bottom: none;
}

.goal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
}

.goal-title {
    font-weight: 600;
    color: #2c3e50;
}

.goal-percentage {
    font-weight: 700;
    color: #27ae60;
}

.goal-progress {
    width: 100%;
    height: 8px;
    background: #f8f9fa;
    border-radius: 4px;
    overflow: hidden;
    margin-bottom: 8px;
}

.goal-progress-bar {
    height: 100%;
    background: linear-gradient(135deg, #2ecc71, #27ae60);
    border-radius: 4px;
    transition: width 0.3s ease;
}

.goal-details {
    display: flex;
    justify-content: space-between;
    font-size: 12px;
    color: #7f8c8d;
}

/* Modal Styles */
.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.5);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 2000;
}

.modal-overlay.active {
    display: flex;
}

.modal-content {
    background: white;
    border-radius: 15px;
    padding: 30px;
    max-width: 500px;
    width: 90%;
    max-height: 90vh;
    overflow-y: auto;
    box-shadow: 0 20px 60px rgba(0,0,0,0.3);
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 25px;
    padding-bottom: 15px;
    border-bottom: 1px solid #f1f3f4;
}

.modal-title {
    font-size: 20px;
    font-weight: 700;
    color: #2c3e50;
}

.modal-close {
    background: none;
    border: none;
    font-size: 24px;
    cursor: pointer;
    color: #7f8c8d;
    padding: 5px;
    border-radius: 50%;
    transition: all 0.3s ease;
}

.modal-close:hover {
    background: #f8f9fa;
    color: #e74c3c;
}

.form-group {
    margin-bottom: 20px;
}

.form-label {
    display: block;
    margin-bottom: 8px;
    font-weight: 600;
    color: #2c3e50;
    font-size: 14px;
}

.form-input, .form-select {
    width: 100%;
    padding: 12px 15px;
    border: 1px solid #e0e6ed;
    border-radius: 8px;
    font-size: 14px;
    transition: all 0.3s ease;
}

.form-input:focus, .form-select:focus {
    outline: none;
    border-color: #3498db;
    box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
}

.modal-actions {
    display: flex;
    gap: 15px;
    justify-content: flex-end;
    margin-top: 25px;
    padding-top: 15px;
    border-top: 1px solid #f1f3f4;
}

.btn-cancel {
    background: #95a5a6;
    color: white;
    border: none;
    padding: 12px 24px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
    transition: all 0.3s ease;
}

.btn-cancel:hover {
    background: #7f8c8d;
}

.btn-primary {
    background: linear-gradient(135deg, #2ecc71, #27ae60);
    color: white;
    border: none;
    padding: 12px 24px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
    transition: all 0.3s ease;
}

.btn-primary:hover {
    transform: translateY(-1px);
    box-shadow: 0 5px 15px rgba(46, 204, 113, 0.3);
}

/* Mobile Responsive */
.mobile-menu-btn {
    display: none;
}

@media (max-width: 768px) {
    .sidebar {
        width: 70px;
        transform: translateX(-100%);
    }
    
    .sidebar.mobile-open {
        transform: translateX(0);
        width: 280px;
    }
    
    .main-content {
        margin-left: 0;
        width: 100%;
    }

    .main-content.expanded {
        margin-left: 0;
    }

    .dashboard-content {
        padding: 15px;
    }

    .earnings-stats {
        grid-template-columns: repeat(2, 1fr);
    }

    .earnings-grid {
        grid-template-columns: 1fr;
    }

    .period-buttons {
        flex-wrap: wrap;
    }

    .custom-period {
        flex-direction: column;
        align-items: stretch;
    }

    .payment-table {
        min-width: 600px;
    }

    .mobile-menu-btn {
        display: block;
        background: none;
        border: none;
        color: #2c3e50;
        font-size: 20px;
        cursor: pointer;
        padding: 5px;
        border-radius: 5px;
        margin-right: 15px;
    }

    .mobile-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0,0,0,0.5);
        z-index: 999;
    }

    .mobile-overlay.active {
        display: block;
    }
}
</style>
</head>
<body>
<div class="dashboard-container">
    <!-- Sidebar -->
    <body>
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <i class="fas fa-leaf"></i>
                <span>EcoWaste</span>
            </div>
            <button class="collapse-btn" onclick="toggleSidebar()">
                <i class="fas fa-bars"></i>
            </button>
        </div>
        <nav class="sidebar-menu">
            <a href="collector_dashboard (3).html" class="menu-item">
                <i class="fas fa-chart-pie"></i>
                <span>Dashboard</span>
            </a>
            <a href="collector_assigned_pickups.html" class="menu-item">
                <i class="fas fa-truck"></i>
                <span>Assigned Pickups</span>
            </a>
            <a href="collector_collection_history (3).html" class="menu-item">
                <i class="fas fa-history"></i>
                <span>Collection History</span>
            </a>
            <a href="collector_earnings (2).html" class="menu-item active">
                <i class="fas fa-money-bill-wave"></i>
                <span>Earnings</span>
            </a>
            <a href="collector_analytics.html" class="menu-item">
                <i class="fas fa-chart-bar"></i>
                <span>Analytics</span>
            </a>
        </nav>
    </div>

    <!-- Main Content -->
    <div class="main-content" id="mainContent">
        <!-- Top Navigation -->
        <div class="top-nav">
            <button class="mobile-menu-btn" onclick="toggleMobileMenu()">
                <i class="fas fa-bars"></i>
            </button>
            <h1 class="nav-title">Earnings</h1>
            <div class="user-profile">
                <div class="user-avatar">JC</div>
                <div class="user-info">
                    <h4>John Collector</h4>
                    <p>Waste Collector</p>
                </div>
            </div>
        </div>

        <div class="dashboard-content">
            <!-- Page Header -->
            <div class="page-header">
                <div class="breadcrumbs">
                    <span class="breadcrumb-item">Collector</span>
                    <i class="fas fa-chevron-right"></i>
                    <span class="breadcrumb-item active">Earnings</span>
                </div>
                <div class="quick-actions">
                    <button class="action-btn-header withdraw-btn" onclick="requestWithdrawal()">
                        <i class="fas fa-credit-card"></i> Request Withdrawal
                    </button>
                    <button class="action-btn-header" onclick="downloadEarningsReport()">
                        <i class="fas fa-file-pdf"></i> Download Report
                    </button>
                </div>
            </div>

            <!-- Earnings Overview -->
            <div class="earnings-overview">
                <div class="earnings-content">
                    <h2 class="earnings-title">Your Financial Dashboard ðŸ’°</h2>
                    <p class="earnings-subtitle">Track your earnings, goals, and financial growth over time</p>
                    <div class="earnings-stats">
                        <div class="earnings-stat">
                            <div class="earnings-stat-value" id="totalEarnings">$3,680</div>
                            <div class="earnings-stat-label">Total Earnings</div>
                        </div>
                        <div class="earnings-stat">
                            <div class="earnings-stat-value" id="currentBalance">$1,240</div>
                            <div class="earnings-stat-label">Current Balance</div>
                        </div>
                        <div class="earnings-stat">
                            <div class="earnings-stat-value" id="monthlyEarnings">$850</div>
                            <div class="earnings-stat-label">This Month</div>
                        </div>
                        <div class="earnings-stat">
                            <div class="earnings-stat-value" id="averageDaily">$42.50</div>
                            <div class="earnings-stat-label">Daily Average</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Period Selector -->
            <div class="period-selector">
                <div class="period-header">
                    <h3 class="period-title">Select Time Period</h3>
                    <div class="period-buttons">
                        <button class="period-btn active" onclick="setPeriod('week')" data-period="week">This Week</button>
                        <button class="period-btn" onclick="setPeriod('month')" data-period="month">This Month</button>
                        <button class="period-btn" onclick="setPeriod('quarter')" data-period="quarter">This Quarter</button>
                        <button class="period-btn" onclick="setPeriod('year')" data-period="year">This Year</button>
                    </div>
                </div>
                <div class="custom-period">
                    <span>Custom Period:</span>
                    <input type="date" class="date-input" id="startDate" onchange="updateCustomPeriod()">
                    <span>to</span>
                    <input type="date" class="date-input" id="endDate" onchange="updateCustomPeriod()">
                </div>
            </div>

            <!-- Main Earnings Grid -->
            <div class="earnings-grid">
                <!-- Earnings Chart -->
                <div class="chart-container">
                    <div class="chart-header">
                        <div>
                            <h3 class="chart-title">Earnings Trend</h3>
                            <p class="chart-subtitle">Daily earnings over the selected period</p>
                        </div>
                    </div>
                    <canvas id="earningsChart" class="chart-canvas"></canvas>
                </div>

                <!-- Earnings Breakdown -->
                <div class="earnings-breakdown">
                    <div class="chart-header">
                        <h3 class="chart-title">Earnings by Waste Type</h3>
                    </div>
                    <div id="breakdownContainer">
                        <!-- Breakdown items will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Goals Section -->
            <div class="goals-section">
                <div class="chart-header">
                    <h3 class="chart-title">
                        <i class="fas fa-target"></i>
                        Financial Goals
                    </h3>
                </div>
                <div class="goal-item">
                    <div class="goal-header">
                        <span class="goal-title">Monthly Target ($1,000)</span>
                        <span class="goal-percentage">85%</span>
                    </div>
                    <div class="goal-progress">
                        <div class="goal-progress-bar" style="width: 85%"></div>
                    </div>
                    <div class="goal-details">
                        <span>$850 of $1,000</span>
                        <span>$150 remaining</span>
                    </div>
                </div>
                <div class="goal-item">
                    <div class="goal-header">
                        <span class="goal-title">Quarterly Target ($3,000)</span>
                        <span class="goal-percentage">73%</span>
                    </div>
                    <div class="goal-progress">
                        <div class="goal-progress-bar" style="width: 73%"></div>
                    </div>
                    <div class="goal-details">
                        <span>$2,190 of $3,000</span>
                        <span>$810 remaining</span>
                    </div>
                </div>
                <div class="goal-item">
                    <div class="goal-header">
                        <span class="goal-title">Annual Target ($12,000)</span>
                        <span class="goal-percentage">61%</span>
                    </div>
                    <div class="goal-progress">
                        <div class="goal-progress-bar" style="width: 61%"></div>
                    </div>
                    <div class="goal-details">
                        <span>$7,320 of $12,000</span>
                        <span>$4,680 remaining</span>
                    </div>
                </div>
            </div>

            <!-- Payment History -->
            <div class="payment-history">
                <div class="payment-header">
                    <h3 class="section-title">
                        <i class="fas fa-credit-card"></i>
                        Payment History
                    </h3>
                    <div class="payment-filters">
                        <button class="filter-btn active" onclick="filterPayments('all')" data-filter="all">All</button>
                        <button class="filter-btn" onclick="filterPayments('paid')" data-filter="paid">Paid</button>
                        <button class="filter-btn" onclick="filterPayments('pending')" data-filter="pending">Pending</button>
                        <button class="filter-btn" onclick="filterPayments('processing')" data-filter="processing">Processing</button>
                    </div>
                </div>
                
                <table class="payment-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Payment ID</th>
                            <th>Amount</th>
                            <th>Method</th>
                            <th>Status</th>
                            <th>Reference</th>
                        </tr>
                    </thead>
                    <tbody id="paymentTableBody">
                        <!-- Payment rows will be loaded here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- Withdrawal Request Modal -->
<div class="modal-overlay" id="withdrawalModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 class="modal-title">Request Withdrawal</h3>
            <button class="modal-close" onclick="closeWithdrawalModal()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="modal-body">
            <div class="form-group">
                <label class="form-label">Available Balance</label>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <span style="font-size: 24px; font-weight: 700; color: #27ae60;">$1,240.00</span>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">Withdrawal Amount *</label>
                <input type="number" class="form-input" id="withdrawalAmount" placeholder="Enter amount" min="10" max="1240" step="0.01">
                <small style="color: #7f8c8d; margin-top: 5px; display: block;">Minimum withdrawal: $10.00</small>
            </div>
            <div class="form-group">
                <label class="form-label">Payment Method *</label>
                <select class="form-select" id="paymentMethod">
                    <option value="">Select payment method</option>
                    <option value="bank">Bank Transfer</option>
                    <option value="paypal">PayPal</option>
                    <option value="mobile">Mobile Money</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Account Details *</label>
                <input type="text" class="form-input" id="accountDetails" placeholder="Enter account number or email">
            </div>
            <div class="form-group">
                <label class="form-label">Notes (Optional)</label>
                <input type="text" class="form-input" id="withdrawalNotes" placeholder="Additional notes">
            </div>
        </div>
        <div class="modal-actions">
            <button class="btn-cancel" onclick="closeWithdrawalModal()">Cancel</button>
            <button class="btn-primary" onclick="submitWithdrawal()">Request Withdrawal</button>
        </div>
    </div>
</div>

<!-- Mobile Overlay -->
<div class="mobile-overlay" id="mobileOverlay" onclick="toggleMobileMenu()"></div>

<script>
// Sample earnings and payment data
let earningsData = {
    totalEarnings: 3680,
    currentBalance: 1240,
    monthlyEarnings: 850,
    dailyAverage: 42.50
};

let wasteTypeEarnings = [
    { type: 'plastic', amount: 420.50, percentage: 25, icon: 'fas fa-recycle' },
    { type: 'paper', amount: 380.25, percentage: 22, icon: 'fas fa-newspaper' },
    { type: 'ewaste', amount: 650.00, percentage: 35, icon: 'fas fa-tv' },
    { type: 'metal', amount: 290.75, percentage: 18, icon: 'fas fa-cog' },
    { type: 'glass', amount: 180.30, percentage: 12, icon: 'fas fa-wine-bottle' },
    { type: 'organic', amount: 120.80, percentage: 8, icon: 'fas fa-leaf' }
];

let paymentHistory = [
    {
        id: 'PAY001',
        date: '2024-08-01',
        amount: 450.00,
        method: 'Bank Transfer',
        status: 'paid',
        reference: 'TXN-2024-001'
    },
    {
        id: 'PAY002',
        date: '2024-07-25',
        amount: 380.50,
        method: 'PayPal',
        status: 'paid',
        reference: 'PP-2024-002'
    },
    {
        id: 'PAY003',
        date: '2024-07-18',
        amount: 290.75,
        method: 'Mobile Money',
        status: 'paid',
        reference: 'MM-2024-003'
    },
    {
        id: 'PAY004',
        date: '2024-08-05',
        amount: 125.00,
        method: 'Bank Transfer',
        status: 'processing',
        reference: 'TXN-2024-004'
    },
    {
        id: 'PAY005',
        date: '2024-08-03',
        amount: 200.00,
        method: 'PayPal',
        status: 'pending',
        reference: 'PP-2024-005'
    }
];

let filteredPayments = [...paymentHistory];
let currentPeriod = 'week';
let earningsChart;

// Initialize page
document.addEventListener('DOMContentLoaded', function() {
    updateEarningsStats();
    loadEarningsBreakdown();
    loadPaymentHistory();
    initializeEarningsChart();
    setDateInputs();
});

// Update earnings statistics
function updateEarningsStats() {
    document.getElementById('totalEarnings').textContent = `${earningsData.totalEarnings.toLocaleString()}`;
    document.getElementById('currentBalance').textContent = `${earningsData.currentBalance.toLocaleString()}`;
    document.getElementById('monthlyEarnings').textContent = `${earningsData.monthlyEarnings.toLocaleString()}`;
    document.getElementById('averageDaily').textContent = `${earningsData.dailyAverage.toFixed(2)}`;
}

// Load earnings breakdown by waste type
function loadEarningsBreakdown() {
    const container = document.getElementById('breakdownContainer');
    
    container.innerHTML = wasteTypeEarnings.map(item => `
        <div class="breakdown-item">
            <div class="breakdown-label">
                <div class="breakdown-icon icon-${item.type}">
                    <i class="${item.icon}"></i>
                </div>
                <span>${item.type.charAt(0).toUpperCase() + item.type.slice(1)}</span>
            </div>
            <div style="text-align: right;">
                <div class="breakdown-value">
                    ${item.amount.toFixed(2)}
                    <span class="breakdown-percentage">(${item.percentage}%)</span>
                </div>
            </div>
        </div>
    `).join('');
}

// Initialize earnings chart
function initializeEarningsChart() {
    const ctx = document.getElementById('earningsChart').getContext('2d');
    
    // Generate sample data for the chart
    const labels = [];
    const data = [];
    
    // Generate last 7 days data
    for (let i = 6; i >= 0; i--) {
        const date = new Date();
        date.setDate(date.getDate() - i);
        labels.push(date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }));
        data.push(Math.floor(Math.random() * 60) + 20); // Random earnings between $20-$80
    }
    
    earningsChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: labels,
            datasets: [{
                label: 'Daily Earnings ($)',
                data: data,
                borderColor: '#2ecc71',
                backgroundColor: 'rgba(46, 204, 113, 0.1)',
                borderWidth: 3,
                fill: true,
                tension: 0.4,
                pointBackgroundColor: '#2ecc71',
                pointBorderColor: '#fff',
                pointBorderWidth: 2,
                pointRadius: 6
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: false
                }
            },
            scales: {
                x: {
                    grid: {
                        display: false
                    }
                },
                y: {
                    beginAtZero: true,
                    grid: {
                        color: '#f1f3f4'
                    },
                    ticks: {
                        callback: function(value) {
                            return ' + value;
                        }
                    }
                }
            },
            elements: {
                point: {
                    hoverRadius: 8
                }
            }
        }
    });
}

// Set period
function setPeriod(period) {
    currentPeriod = period;
    
    // Update active button
    document.querySelectorAll('.period-btn').forEach(btn => btn.classList.remove('active'));
    document.querySelector(`[data-period="${period}"]`).classList.add('active');
    
    // Update chart data based on period
    updateChartData(period);
    
    showNotification(`Displaying earnings for: ${period}`, 'info');
}

// Update chart data based on period
function updateChartData(period) {
    const { labels, data } = generateEarningsData(period);
    
    // Update chart title based on period
    const chartTitles = {
        'week': 'Daily Earnings - This Week',
        'month': 'Daily Earnings - This Month', 
        'quarter': 'Weekly Earnings - This Quarter',
        'year': 'Monthly Earnings - This Year'
    };
    
    const chartSubtitles = {
        'week': 'Last 7 days of collection earnings',
        'month': 'Daily earnings for the current month',
        'quarter': 'Weekly totals for the last 12 weeks', 
        'year': 'Monthly totals for the current year'
    };
    
    // Update chart title in DOM
    document.querySelector('.chart-title').textContent = chartTitles[period];
    document.querySelector('.chart-subtitle').textContent = chartSubtitles[period];
    
    // Calculate statistics for the period
    const total = data.reduce((sum, value) => sum + value, 0);
    const average = total / data.length;
    const highest = Math.max(...data);
    const lowest = Math.min(...data);
    
    // Update chart data
    earningsChart.data.labels = labels;
    earningsChart.data.datasets[0].data = data;
    
    // Update chart options based on period
    if (period === 'quarter' || period === 'year') {
        earningsChart.data.datasets[0].label = period === 'quarter' ? 'Weekly Earnings ($)' : 'Monthly Earnings ($)';
    } else {
        earningsChart.data.datasets[0].label = 'Daily Earnings ($)';
    }
    
    // Animate the chart update
    earningsChart.update('active');
    
    // Show statistics in a tooltip or notification
    const periodStats = {
        'week': `Week Total: ${total.toFixed(2)} | Daily Avg: ${average.toFixed(2)}`,
        'month': `Month Total: ${total.toFixed(2)} | Daily Avg: ${average.toFixed(2)}`,
        'quarter': `Quarter Total: ${total.toFixed(2)} | Weekly Avg: ${average.toFixed(2)}`,
        'year': `Year Total: ${total.toFixed(2)} | Monthly Avg: ${average.toFixed(2)}`
    };
    
    // Update earnings stats based on the selected period
    updatePeriodStats(period, { total, average, highest, lowest });
}

// Update period-specific statistics
function updatePeriodStats(period, stats) {
    // You could update additional stats cards here
    // For now, we'll show the info in the chart area
    
    const chartContainer = document.querySelector('.chart-container');
    let statsElement = chartContainer.querySelector('.period-stats');
    
    if (!statsElement) {
        statsElement = document.createElement('div');
        statsElement.className = 'period-stats';
        statsElement.style.cssText = `
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-top: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            font-size: 12px;
        `;
        chartContainer.appendChild(statsElement);
    }
    
    const periodLabels = {
        'week': { total: 'Week Total', avg: 'Daily Avg', high: 'Best Day', low: 'Lowest Day' },
        'month': { total: 'Month Total', avg: 'Daily Avg', high: 'Best Day', low: 'Lowest Day' },
        'quarter': { total: 'Quarter Total', avg: 'Weekly Avg', high: 'Best Week', low: 'Lowest Week' },
        'year': { total: 'Year Total', avg: 'Monthly Avg', high: 'Best Month', low: 'Lowest Month' }
    };
    
    const labels = periodLabels[period];
    
    statsElement.innerHTML = `
        <div style="text-align: center;">
            <div style="font-weight: 700; color: #27ae60; font-size: 16px;">${stats.total.toFixed(2)}</div>
            <div style="color: #7f8c8d;">${labels.total}</div>
        </div>
        <div style="text-align: center;">
            <div style="font-weight: 700; color: #3498db; font-size: 16px;">${stats.average.toFixed(2)}</div>
            <div style="color: #7f8c8d;">${labels.avg}</div>
        </div>
        <div style="text-align: center;">
            <div style="font-weight: 700; color: #2ecc71; font-size: 16px;">${stats.highest.toFixed(2)}</div>
            <div style="color: #7f8c8d;">${labels.high}</div>
        </div>
        <div style="text-align: center;">
            <div style="font-weight: 700; color: #e67e22; font-size: 16px;">${stats.lowest.toFixed(2)}</div>
            <div style="color: #7f8c8d;">${labels.low}</div>
        </div>
    `;
}

// Update custom period
function updateCustomPeriod() {
    const startDate = document.getElementById('startDate').value;
    const endDate = document.getElementById('endDate').value;
    
    if (startDate && endDate) {
        const start = new Date(startDate);
        const end = new Date(endDate);
        
        // Validate date range
        if (start > end) {
            alert('Start date must be before end date');
            return;
        }
        
        const diffTime = Math.abs(end - start);
        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)) + 1;
        
        // Limit to reasonable ranges
        if (diffDays > 365) {
            alert('Please select a date range of 365 days or less');
            return;
        }
        
        // Clear active period buttons
        document.querySelectorAll('.period-btn').forEach(btn => btn.classList.remove('active'));
        
        // Generate custom data
        const labels = [];
        const data = [];
        const weekdayMultipliers = [0.7, 0.8, 1.0, 1.1, 1.2, 1.3, 1.0]; // Sun-Sat
        
        for (let i = 0; i < diffDays; i++) {
            const date = new Date(start.getTime() + i * 24 * 60 * 60 * 1000);
            const dayOfWeek = date.getDay();
            
            // Format label based on range length
            if (diffDays <= 7) {
                labels.push(date.toLocaleDateString('en-US', { weekday: 'short' }));
            } else if (diffDays <= 31) {
                labels.push(date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }));
            } else {
                // For longer ranges, show every week or month
                if (i % 7 === 0 || i === diffDays - 1) {
                    labels.push(date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }));
                } else {
                    labels.push('');
                }
            }
            
            // Generate realistic earnings data
            const baseEarnings = 45;
            const variation = (Math.random() - 0.5) * 20;
            const dayMultiplier = weekdayMultipliers[dayOfWeek];
            const earnings = Math.max(0, baseEarnings * dayMultiplier + variation);
            
            data.push(Math.round(earnings * 100) / 100);
        }
        
        // Update chart
        document.querySelector('.chart-title').textContent = 'Custom Period Earnings';
        document.querySelector('.chart-subtitle').textContent = `${startDate} to ${endDate} (${diffDays} days)`;
        
        earningsChart.data.labels = labels;
        earningsChart.data.datasets[0].data = data;
        earningsChart.data.datasets[0].label = 'Daily Earnings ($)';
        earningsChart.update('active');
        
        // Calculate and show custom period stats
        const total = data.reduce((sum, value) => sum + value, 0);
        const average = total / data.length;
        const highest = Math.max(...data);
        const lowest = Math.min(...data);
        
        updatePeriodStats('custom', { total, average, highest, lowest });
        
        showNotification(`Custom period: ${diffDays} days | Total: ${total.toFixed(2)}`, 'info');
    }
}

// Load payment history
function loadPaymentHistory() {
    const tbody = document.getElementById('paymentTableBody');
    
    tbody.innerHTML = filteredPayments.map(payment => `
        <tr>
            <td>${formatDate(payment.date)}</td>
            <td><strong>${payment.id}</strong></td>
            <td class="payment-amount">${payment.amount.toFixed(2)}</td>
            <td>${payment.method}</td>
            <td>
                <span class="payment-status status-${payment.status}">
                    ${payment.status}
                </span>
            </td>
            <td><small>${payment.reference}</small></td>
        </tr>
    `).join('');
}

// Filter payments
function filterPayments(status) {
    // Update active filter button
    document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
    document.querySelector(`[data-filter="${status}"]`).classList.add('active');
    
    // Filter payments
    if (status === 'all') {
        filteredPayments = [...paymentHistory];
    } else {
        filteredPayments = paymentHistory.filter(payment => payment.status === status);
    }
    
    loadPaymentHistory();
}

// Withdrawal functions
function requestWithdrawal() {
    const modal = document.getElementById('withdrawalModal');
    modal.classList.add('active');
}

function closeWithdrawalModal() {
    const modal = document.getElementById('withdrawalModal');
    modal.classList.remove('active');
    
    // Clear form
    document.getElementById('withdrawalAmount').value = '';
    document.getElementById('paymentMethod').value = '';
    document.getElementById('accountDetails').value = '';
    document.getElementById('withdrawalNotes').value = '';
}

function submitWithdrawal() {
    const amount = parseFloat(document.getElementById('withdrawalAmount').value);
    const method = document.getElementById('paymentMethod').value;
    const accountDetails = document.getElementById('accountDetails').value;
    const notes = document.getElementById('withdrawalNotes').value;
    
    // Validation
    if (!amount || amount < 10 || amount > 1240) {
        alert('Please enter a valid amount between $10 and $1,240');
        return;
    }
    
    if (!method) {
        alert('Please select a payment method');
        return;
    }
    
    if (!accountDetails) {
        alert('Please enter account details');
        return;
    }
    
    // Create new payment record
    const newPayment = {
        id: 'PAY' + String(paymentHistory.length + 1).padStart(3, '0'),
        date: new Date().toISOString().split('T')[0],
        amount: amount,
        method: method,
        status: 'pending',
        reference: 'REQ-' + Date.now()
    };
    
    paymentHistory.unshift(newPayment);
    filteredPayments = [...paymentHistory];
    
    // Update balance
    earningsData.currentBalance -= amount;
    updateEarningsStats();
    
    loadPaymentHistory();
    closeWithdrawalModal();
    
    showNotification(`Withdrawal request for ${amount.toFixed(2)} submitted successfully!`, 'success');
}

// Download earnings report
function downloadEarningsReport() {
    const reportData = {
        totalEarnings: earningsData.totalEarnings,
        currentBalance: earningsData.currentBalance,
        monthlyEarnings: earningsData.monthlyEarnings,
        dailyAverage: earningsData.dailyAverage,
        wasteTypeBreakdown: wasteTypeEarnings,
        recentPayments: paymentHistory.slice(0, 10)
    };

    const reportHTML = `
        <div style="font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px;">
            <h1 style="color: #2c3e50; text-align: center; margin-bottom: 30px;">Earnings Report</h1>
            <p style="text-align: center; color: #7f8c8d; margin-bottom: 40px;">
                Generated on ${new Date().toLocaleDateString()} for John Collector
            </p>
            
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-bottom: 40px;">
                <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; text-align: center;">
                    <h3 style="color: #2c3e50; margin-bottom: 10px;">${reportData.totalEarnings.toLocaleString()}</h3>
                    <p style="color: #7f8c8d;">Total Earnings</p>
                </div>
                <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; text-align: center;">
                    <h3 style="color: #27ae60; margin-bottom: 10px;">${reportData.currentBalance.toLocaleString()}</h3>
                    <p style="color: #7f8c8d;">Current Balance</p>
                </div>
                <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; text-align: center;">
                    <h3 style="color: #2c3e50; margin-bottom: 10px;">${reportData.monthlyEarnings.toLocaleString()}</h3>
                    <p style="color: #7f8c8d;">This Month</p>
                </div>
                <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; text-align: center;">
                    <h3 style="color: #2c3e50; margin-bottom: 10px;">${reportData.dailyAverage.toFixed(2)}</h3>
                    <p style="color: #7f8c8d;">Daily Average</p>
                </div>
            </div>
            
            <div style="margin-bottom: 30px;">
                <h3 style="color: #2c3e50; margin-bottom: 15px;">Earnings by Waste Type</h3>
                <table style="width: 100%; border-collapse: collapse;">
                    <thead>
                        <tr style="background: #f8f9fa;">
                            <th style="padding: 10px; border: 1px solid #ddd; text-align: left;">Waste Type</th>
                            <th style="padding: 10px; border: 1px solid #ddd; text-align: right;">Amount</th>
                            <th style="padding: 10px; border: 1px solid #ddd; text-align: right;">Percentage</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${reportData.wasteTypeBreakdown.map(item => `
                            <tr>
                                <td style="padding: 10px; border: 1px solid #ddd;">${item.type.charAt(0).toUpperCase() + item.type.slice(1)}</td>
                                <td style="padding: 10px; border: 1px solid #ddd; text-align: right;">${item.amount.toFixed(2)}</td>
                                <td style="padding: 10px; border: 1px solid #ddd; text-align: right;">${item.percentage}%</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            </div>
        </div>
    `;

    const newWindow = window.open('', '_blank');
    newWindow.document.write(reportHTML);
    newWindow.document.close();
    newWindow.print();

    showNotification('Earnings report generated!', 'success');
}

// Utility functions
function formatDate(dateString) {
    const date = new Date(dateString);
    return date.toLocaleDateString('en-US', { 
        year: 'numeric',
        month: 'short', 
        day: 'numeric'
    });
}

// Navigation functions
function showSection(section) {
    showNotification(`${section.replace('-', ' ')} section would load here.`, 'info');
}

function logout() {
    if (confirm('Are you sure you want to logout?')) {
        showNotification('Logging out...', 'info');
        setTimeout(() => {
            window.location.href = 'login.html';
        }, 1500);
    }
}

// Sidebar toggle
function toggleSidebar() {
    const sidebar = document.getElementById('sidebar');
    const mainContent = document.getElementById('mainContent');
    
    if (sidebar && mainContent) {
        sidebar.classList.toggle('collapsed');
        mainContent.classList.toggle('expanded');
    }
}

// Mobile menu toggle
function toggleMobileMenu() {
    const sidebar = document.getElementById('sidebar');
    const mobileOverlay = document.getElementById('mobileOverlay');
    
    if (sidebar && mobileOverlay) {
        sidebar.classList.toggle('mobile-open');
        mobileOverlay.classList.toggle('active');
    }
}

// Show notification
function showNotification(message, type = 'info') {
    const notification = document.createElement('div');
    notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: ${type === 'success' ? '#27ae60' : type === 'error' ? '#e74c3c' : '#3498db'};
        color: white;
        padding: 15px 20px;
        border-radius: 8px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        z-index: 3000;
        font-weight: 600;
        transform: translateX(100%);
        transition: transform 0.3s ease;
        max-width: 300px;
    `;
    notification.textContent = message;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.style.transform = 'translateX(0)';
    }, 100);
    
    setTimeout(() => {
        notification.style.transform = 'translateX(100%)';
        setTimeout(() => {
            if (document.body.contains(notification)) {
                document.body.removeChild(notification);
            }
        }, 300);
    }, 3000);
}

// Close modals when clicking outside
document.addEventListener('DOMContentLoaded', function() {
    const withdrawalModal = document.getElementById('withdrawalModal');
    
    if (withdrawalModal) {
        withdrawalModal.addEventListener('click', function(e) {
            if (e.target === this) {
                closeWithdrawalModal();
            }
        });
    }
});

// Handle escape key
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        closeWithdrawalModal();
    }
});

console.log('EcoWaste Collector Earnings Page Loaded');
console.log('Current Balance:', earningsData.currentBalance);
</script>
</body>
</html>